var S=Object.defineProperty;var w=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var D=(o,t,r)=>t in o?S(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,u=(o,t)=>{for(var r in t||(t={}))F.call(t,r)&&D(o,r,t[r]);if(w)for(var r of w(t))M.call(t,r)&&D(o,r,t[r]);return o};import{g as B,f as E,a as b,b as v,A as x,c as O,m as q}from"./api.7352dcea.js";import{_ as z,b as H,r as T,s as J,m as L,h as g,o as N,c as P,a as C,i as d,w as m,p as V,k as j,l as y}from"./index.a37b34e1.js";const l=H({token:"qiYrxXEv5mJPW6-dU5_wQdp8SsiVs57z8ira8KcUOZIwg4wLheerdJZ6xrqBkEC4jOWbtqSTZRPZtc4W4fqoS0DquTKr7K1okm5tOnVjvmEbxsiXnEwdq5WMYGM8bzpyknP3uplGOnrbffunfFJpQQvIHV7ILPKYpAFyJdOxf5zBpfMVuLE0m5yBF1JOBzyIUOMtvMWPf4uSuyE-lOEC2wPmXvHnm6Ry9s6SqiafwcKXLciIFVZ3JqkYiiDcvVB9TnC3TUH1UooAmjhk3AH2wQ==",projectCode:"169",timeType:"1h",polType:"134004",hasCamera:"",devsiteProp:"2",dataTime:(Date.now()/36e5).toFixed()*36e5,admId:"110102007",admLevel:"4"});var p=null,I;const U={name:"mapcomtaint",setup(){const o=T(!1),t=J(null),r=T(null);B().then(a=>{console.log(a),l.dataTime=E(a.result),console.log(l.dataTime)});const n=()=>{l.timeType=="1h"?l.dataTime+=36e5:l.dataTime+=864e5,console.log(l.dataTime);let a=u({},l);l.timeType=="1h"?a.dataTime=v(a.dataTime):a.dataTime=b(a.dataTime),console.log(JSON.stringify(a)),_(a)},_=a=>{O(JSON.stringify(a)).then(e=>{var i=p.getAllOverlays("marker");console.log(i),p.remove(i),console.log(e),console.log("getRegionQCData OK"),e.result.forEach(function(s){s.data[0].values[0].qc_value<0||AMap.convertFrom([s.lng,s.lat],"gps",function(f,c){if(c.info==="ok"){console.log("convertFrom \u5750\u6807\u8F6C\u6362 OK");var h='<div class="marker_type_'+q(s.data[0].values[0].qc_value)+'"></div><div class="marker_label">'+s.data[0].values[0].qc_value.toFixed()+"</br>"+s.name+"</div>";let k=new AMap.Marker({content:h,position:[c.locations[0].lng,c.locations[0].lat]});p.add(k)}})})})};return L(()=>{p.destroy()}),{formRef:r,size:T("medium"),map:t,data:l,nextFunc:n,updateMarker:_,loading:o,timeDisabled(a){const e=new Date(a).getDate();return console.log(e<15),{isMinuteDisabled:i=>i>0,isSecondDisabled:i=>i>0}},rules:{pointName:{required:!0,trigger:["blur","input"],message:"\u8BF7\u8F93\u5165\u70B9\u4F4D\u540D\u79F0/\u70B9\u4F4DID"}},handleDayFormSwitch(a){a.preventDefault();var e=document.getElementById("panorama_form_item_datetime");e.style.display="none",e=document.getElementById("panorama_form_item_date"),e.style.display="block",l.timeType="1d";let i=u({},l);i.dataTime=b(i.dataTime),console.log(JSON.stringify(i)),_(i)},handleHourFormSwitch(a){a.preventDefault();var e=document.getElementById("panorama_form_item_date");e.style.display="none",e=document.getElementById("panorama_form_item_datetime"),e.style.display="block",l.timeType="1h";let i=u({},l);i.dataTime=v(i.dataTime),console.log(JSON.stringify(i)),_(i)},handleFormLastClick(a){a.preventDefault(),l.timeType=="1h"?l.dataTime-=36e5:l.dataTime-=864e5,console.log(l.dataTime);let e=u({},l);l.timeType=="1h"?e.dataTime=v(e.dataTime):e.dataTime=b(e.dataTime),console.log(JSON.stringify(e)),_(e)},handleFormNextClick(a){a.preventDefault(),n()},handleFormPlayClick(a){a.preventDefault();let e=document.getElementById("panorama_play_btn");e.style.display="none",e=document.getElementById("panorama_stop_btn"),e.style.display="block",I=setInterval(n,1*1e3)},handleFormStopClick(a){a.preventDefault();let e=document.getElementById("panorama_play_btn");e.style.display="block",e=document.getElementById("panorama_stop_btn"),e.style.display="none",clearInterval(I)}}},create(){},methods:{ininMap(){x.load({key:"4802a5f88a46631c672d7498a98e59a8",version:"2.0",plugins:["AMap.ToolBar","AMap.Driving","AMap.DistrictSearch"],AMapUI:{version:"1.1",plugins:[]},Loca:{version:"2.0.0"}}).then(o=>{p=new o.Map("panorama_map_container",{viewMode:"3D",zoom:12,zooms:[2,22],center:[116.347,39.91]});var t=document.getElementById("panorama_form_item_date");t.style.display="none",t=document.getElementById("panorama_form_item_datetime"),t.style.display="block",t=document.getElementById("panorama_stop_btn"),t.style.display="none",l.timeType="1h";let r=u({},l);r.dataTime=v(r.dataTime),console.log(JSON.stringify(r)),this.updateMarker(r);var n=new o.ImageLayer({bounds:new o.Bounds([116.33446645401432,39.897422578744],[116.36063757117489,39.91858235094773]),url:"https://s3.bmp.ovh/imgs/2022/06/22/7c70ea19ade8d6fd.png",zIndex:6,zooms:[12,18]});p.add(n),p.setFitView(n);var _={subdistrict:2,extensions:"all",level:"district"},a=new o.DistrictSearch(_);a.search("\u897F\u57CE\u533A",function(e,i){console.log("DistrictSearch:",e);var s=[],f=i.districtList[0].boundaries;if(f)for(var c=0,h=f.length;c<h;c++){var k=new o.Polygon({strokeWeight:1,path:f[c],fillOpacity:.4,fillColor:"#80d8ff",strokeColor:"#0091ea",zooms:[10,14]});s.push(k)}p.add(s)}),console.log("load finish!")}).catch(o=>{console.log(o)})},addMarker(){}},mounted(){this.ininMap()}},A=o=>(V("data-v-76a026be"),o=o(),j(),o),R={class:"home_div"},K=A(()=>C("div",{id:"panorama_map_container"},null,-1)),Q={class:"bottom-bar"},W=y(" \u65E5 "),Z=y(" \u65F6 "),X=y(" \u2B9C"),Y=y(" \u2B9E "),G=y(" \u1405 "),$=y(" \u2016 "),ee=["src"];function ae(o,t,r,n,_,a){const e=g("n-button"),i=g("n-date-picker"),s=g("n-form-item"),f=g("n-form");return N(),P("div",R,[K,C("div",Q,[d(e,{class:"switch_btn","attr-type":"button",onClick:n.handleDayFormSwitch},{default:m(()=>[W]),_:1},8,["onClick"]),d(e,{class:"switch_btn","attr-type":"button",onClick:n.handleHourFormSwitch},{default:m(()=>[Z]),_:1},8,["onClick"]),d(f,{id:"panorama_form",ref:"formRef",model:n.data,rules:n.rules,inline:!0,"show-label":!1,"label-width":"auto","require-mark-placement":"right-hanging",size:n.size,"show-feedback":!1},{default:m(()=>[d(s,{id:"panorama_form_item_date",class:"panorama_form_item",path:"dataTime"},{default:m(()=>[d(i,{value:n.data.dataTime,"onUpdate:value":t[0]||(t[0]=c=>n.data.dataTime=c),"value-format":"yyyy-MM-dd HH:00:00",type:"date"},null,8,["value"])]),_:1}),d(s,{id:"panorama_form_item_datetime",class:"panorama_form_item",path:"dataTime"},{default:m(()=>[d(i,{value:n.data.dataTime,"onUpdate:value":t[1]||(t[1]=c=>n.data.dataTime=c),"value-format":"yyyy-MM-dd HH:00:00",type:"datetime","is-time-disabled":n.timeDisabled},null,8,["value","is-time-disabled"])]),_:1}),d(s,{class:"panorama_form_item"},{default:m(()=>[d(e,{"attr-type":"button",onClick:n.handleFormLastClick},{default:m(()=>[X]),_:1},8,["onClick"])]),_:1}),d(s,{class:"panorama_form_item"},{default:m(()=>[d(e,{"attr-type":"button",onClick:n.handleFormNextClick},{default:m(()=>[Y]),_:1},8,["onClick"])]),_:1}),d(s,{id:"panorama_play_btn",class:"panorama_form_item"},{default:m(()=>[d(e,{"attr-type":"button",onClick:n.handleFormPlayClick},{default:m(()=>[G]),_:1},8,["onClick"])]),_:1}),d(s,{id:"panorama_stop_btn",class:"panorama_form_item"},{default:m(()=>[d(e,{"attr-type":"button",onClick:n.handleFormStopClick},{default:m(()=>[$]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules","size"]),C("img",{id:"air_color_img",src:"/air_color.png"},null,8,ee)])])}var ie=z(U,[["render",ae],["__scopeId","data-v-76a026be"]]);export{ie as default};
